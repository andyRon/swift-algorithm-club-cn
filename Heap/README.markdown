# å †(Heap)

> è¿™ä¸ªè¯é¢˜å·²ç»æœ‰ä¸ªè¾…å¯¼[æ–‡ç« ](https://www.raywenderlich.com/160631/swift-algorithm-club-heap-and-priority-queue-data-structure)


å †æ˜¯æ•°ç»„å†…çš„[äºŒå‰æ ‘](../Binary%20Tree/)ï¼Œå› æ­¤å®ƒä¸ä½¿ç”¨çˆ¶/å­æŒ‡é’ˆã€‚ å †åŸºäºâ€œå †å±æ€§â€è¿›è¡Œæ’åºï¼Œâ€œå †å±æ€§â€ç¡®å®šæ ‘ä¸­èŠ‚ç‚¹çš„é¡ºåºã€‚


å †çš„ä¸€èˆ¬ç”¨é€”ï¼š

- æ„å»º[ä¼˜å…ˆé˜Ÿåˆ—](../Priority%20Queue)ã€‚
- æ”¯æŒ[å †æ’åº](../Heap%20Sort/)ã€‚
- å¿«é€Ÿè®¡ç®—é›†åˆä¸­æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰å€¼ã€‚
- ç»™ä½ çš„éç¨‹åºå‘˜æœ‹å‹ç•™ä¸‹æ·±åˆ»å½±å“ã€‚



## å †å±æ€§


æœ‰ä¸¤ç§å †ï¼š*max-heap* å’Œ *min-heap*ï¼Œå®ƒä»¬å­˜å‚¨æ ‘èŠ‚ç‚¹çš„é¡ºåºä¸åŒã€‚


åœ¨*max-heap*ä¸­ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼å¤§äºå…¶å­èŠ‚ç‚¹ã€‚ åœ¨*min-heap*ä¸­ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼éƒ½å°äºå…¶å­èŠ‚ç‚¹ã€‚ è¿™ç§°ä¸ºâ€œå †å±æ€§â€ï¼Œå¯¹äºæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¦‚æ­¤ã€‚

ä¸€ä¸ªä¾‹å­ï¼š

![A max-heap](Images/Heap1.png)


è¿™æ˜¯ä¸€ä¸ª*max-heap*ï¼Œå› ä¸ºæ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½å¤§äºå…¶å­èŠ‚ç‚¹ã€‚ `(10)`å¤§äº`(7)`å’Œ`(2)`ã€‚ `(7)`å¤§äº`(5)`å’Œ`(1)`ã€‚

å †å±æ€§çš„ç»“æœæ˜¯ï¼Œ*max-heap*å§‹ç»ˆå°†å…¶æœ€å¤§é¡¹å­˜å‚¨åœ¨æ ‘çš„æ ¹ä¸­ã€‚ å¯¹äº*min-heap*ï¼Œæ ¹å§‹ç»ˆæ˜¯æ ‘ä¸­çš„æœ€å°é¡¹ã€‚ å †å±æ€§å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå †é€šå¸¸ç”¨ä½œ[ä¼˜å…ˆçº§é˜Ÿåˆ—](../Priority%20Queue/)æ¥å¿«é€Ÿè®¿é—®â€œæœ€é‡è¦çš„â€ï¼ˆ**è¯‘æ³¨ï¼š**æœ€å¤§æˆ–æœ€å°ï¼‰å…ƒç´ ã€‚

>  **æ³¨æ„ï¼š** å †çš„æ ¹æ˜¯æœ€å¤§æˆ–æœ€å°å…ƒç´ ï¼Œä½†å…¶ä»–å…ƒç´ çš„æ’åºé¡ºåºæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚ä¾‹å¦‚ï¼Œæœ€å¤§å…ƒç´ å§‹ç»ˆä½äº*max-heap*ä¸­çš„ç´¢å¼•0å¤„ï¼Œä½†æœ€å°å…ƒç´ ä¸ä¸€å®šæ˜¯æœ€åä¸€ä¸ªå…ƒç´ ã€‚ â€”â€” å”¯ä¸€çš„ä¿è¯æ˜¯ï¼Œæœ€å°å…ƒç´ æ˜¯å¶å­èŠ‚ç‚¹ä¹‹ä¸€ï¼Œä½†ä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªã€‚



## å †ä¸å¸¸è§„æ ‘å¯¹æ¯”

å †ä¸æ˜¯äºŒå‰æœç´¢æ ‘çš„æ›¿ä»£å“ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨ç›¸ä¼¼ä¹‹å¤„å’Œä¸åŒä¹‹å¤„ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦å·®å¼‚ï¼š

**èŠ‚ç‚¹çš„é¡ºåºã€‚**åœ¨[äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰](../Binary%20Search%20Tree/)ä¸­ï¼Œå·¦å­èŠ‚ç‚¹å¿…é¡»å°äºå…¶çˆ¶èŠ‚ç‚¹ï¼Œå³å­èŠ‚ç‚¹å¿…é¡»æ›´å¤§ã€‚ å †ä¸æ˜¯è¿™æ ·ã€‚ åœ¨*max-heap*ä¸­ï¼Œä¸¤ä¸ªå­èŠ‚ç‚¹å¿…é¡»å°äºçˆ¶èŠ‚ç‚¹ï¼Œè€Œåœ¨*min-heap*ä¸­ï¼Œå­èŠ‚ç‚¹å¿…é¡»å¤§äºçˆ¶èŠ‚ç‚¹ã€‚

**å†…å­˜ã€‚**ä¼ ç»Ÿçš„æ ‘æ¯”å®ƒä»¬å­˜å‚¨çš„æ•°æ®å ç”¨æ›´å¤šçš„å†…å­˜ã€‚ éœ€è¦ä¸ºèŠ‚ç‚¹å¯¹è±¡å’ŒæŒ‡å‘å·¦/å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆåˆ†é…é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ å †åªä½¿ç”¨æ™®é€šæ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œä¸ä½¿ç”¨æŒ‡é’ˆã€‚


**å¹³è¡¡ã€‚** äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰å¿…é¡»â€œå¹³è¡¡â€ï¼Œä»¥ä¾¿å¤§å¤šæ•°æ“ä½œå…·æœ‰**O(log n)**æ€§èƒ½ã€‚ æ‚¨å¯ä»¥æŒ‰éšæœºé¡ºåºæ’å…¥å’Œåˆ é™¤æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨[AVLæ ‘](../AVL%20Tree/)æˆ–[çº¢é»‘æ ‘](../Red-Black%20Tree/)ï¼Œä½† æˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦å¯¹æ•´ä¸ªæ ‘è¿›è¡Œæ’åºã€‚ æˆ‘ä»¬åªæ˜¯å¸Œæœ›å®ç°å †å±æ€§ï¼Œå› æ­¤å¹³è¡¡ä¸æ˜¯é—®é¢˜ã€‚ ç”±äºå †çš„ç»“æ„æ–¹å¼ï¼Œå †å¯ä»¥ä¿è¯ **O(log n)** çš„æ€§èƒ½ã€‚

**æœç´¢ã€‚** è™½ç„¶åœ¨äºŒå‰æ ‘ä¸­æœç´¢é€Ÿåº¦å¾ˆå¿«ï¼Œä½†åœ¨å †ä¸­æœç´¢é€Ÿåº¦å¾ˆæ…¢ã€‚ æœç´¢ä¸æ˜¯å †ä¸­çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œå› ä¸ºå †çš„ç›®çš„æ˜¯å°†æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰èŠ‚ç‚¹æ”¾åœ¨å‰é¢å¹¶å…è®¸ç›¸å¯¹å¿«é€Ÿçš„æ’å…¥å’Œåˆ é™¤ã€‚



## æ•°ç»„ä¸­çš„æ ‘

ç”¨æ•°ç»„å®ç°æ ‘çŠ¶ç»“æ„ä¼¼ä¹æ¯”è¾ƒå¥‡æ€ªï¼Œä½†å®ƒåœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½å¾ˆé«˜æ•ˆçš„ã€‚

ä¸Šé¢ä¾‹å­ä¸­çš„æ ‘ç”¨æ•°ç»„å­˜å‚¨ä¸ºï¼š

	[ 10, 7, 2, 5, 1 ]

è¿™é‡Œçš„æ‰€æœ‰äº†ï¼ æˆ‘ä»¬ä¸éœ€è¦æ¯”è¿™ä¸ªç®€å•æ•°ç»„æ›´å¤šçš„å­˜å‚¨ç©ºé—´äº†ã€‚

é‚£ä¹ˆï¼Œå¦‚æœä¸å…è®¸ä½¿ç”¨ä»»ä½•æŒ‡é’ˆï¼Œæˆ‘ä»¬å¦‚ä½•çŸ¥é“å“ªäº›èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹ï¼Œå“ªäº›èŠ‚ç‚¹æ˜¯å­èŠ‚ç‚¹ï¼Ÿ å¥½é—®é¢˜ï¼æ ‘èŠ‚ç‚¹çš„æ•°ç»„ç´¢å¼•ä¸å…¶çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„æ•°ç»„ç´¢å¼•ä¹‹é—´å­˜åœ¨æ˜ç¡®å®šä¹‰çš„å…³ç³»ã€‚

å¦‚æœ`i`æ˜¯èŠ‚ç‚¹çš„ç´¢å¼•ï¼Œåˆ™ä»¥ä¸‹å…¬å¼ç»™å‡ºå…¶çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„æ•°ç»„ç´¢å¼•ï¼š

    parent(i) = floor((i - 1)/2)
    left(i)   = 2i + 1
    right(i)  = 2i + 2

æ³¨æ„`right(i)`åªæ˜¯`left(i)+ 1`ã€‚ å·¦ä¾§å’Œå³ä¾§å­èŠ‚ç‚¹å§‹ç»ˆç´§æŒ¨ç€å­˜å‚¨ã€‚

å¯¹ä¸Šé¢çš„ä¾‹å­ä½¿ç”¨è¿™äº›å…¬å¼ã€‚ å¡«å†™æ•°ç»„ç´¢å¼•ï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°æ•°ç»„ä¸­çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„ä½ç½®ï¼š

| èŠ‚ç‚¹ | æ•°ç»„ä¸­çš„ç´¢å¼•(`i`) | çˆ¶èŠ‚ç‚¹ç´¢å¼• | å·¦å­èŠ‚ç‚¹ç´¢å¼• | å³å­èŠ‚ç‚¹ç´¢å¼• |
|:----:|:-----------:|:------------:|:----------:|:-----------:|
| 10 | 0 | -1 | 1 | 2 |
| 7 | 1 | 0 | 3 | 4 |
| 2 | 2 | 0 | 5 | 6 |
| 5 | 3 | 1 | 7 | 8 |
| 1 | 4 | 1 | 9 | 10 |

éªŒè¯è¿™äº›æ•°ç»„ç´¢å¼•ç¡®å®å¯¹åº”äºä¸Šé¢æ ‘çš„å›¾ç‰‡ã€‚

> **æ³¨æ„ï¼š** æ ¹èŠ‚ç‚¹`(10)`æ²¡æœ‰çˆ¶èŠ‚ç‚¹ï¼Œå› ä¸º`-1`ä¸æ˜¯æœ‰æ•ˆçš„æ•°ç»„ç´¢å¼•ã€‚ åŒæ ·ï¼ŒèŠ‚ç‚¹`(2)`ï¼Œ`(5)`å’Œ`(1)`æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå› ä¸ºé‚£äº›ç´¢å¼•å¤§äºæ•°ç»„å¤§å°ï¼Œæ‰€ä»¥ç”¨å®ƒä»¬ä¹‹å‰æˆ‘ä»¬æ€»æ˜¯è¦ç¡®ä¿æˆ‘ä»¬è®¡ç®—çš„ç´¢å¼•å®é™…ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚


å›æƒ³ä¸€ä¸‹ï¼Œåœ¨*max-heap*ä¸­ï¼Œçˆ¶èŠ‚ç‚¹çš„å€¼æ€»æ˜¯å¤§äºï¼ˆæˆ–ç­‰äºï¼‰å…¶å­èŠ‚ç‚¹çš„å€¼ã€‚ è¿™æ„å‘³ç€å¯¹äºæ‰€æœ‰æ•°ç»„ç´¢å¼•`i`å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

```swift
array[parent(i)] >= array[i]
```

éªŒè¯æ­¤å †å±æ€§æ˜¯å¦é€‚ç”¨äºç¤ºä¾‹å †ä¸­çš„æ•°ç»„ã€‚

å¦‚æ‚¨æ‰€è§ï¼Œè¿™äº›ç­‰å¼å…è®¸æˆ‘ä»¬åœ¨ä¸éœ€è¦æŒ‡é’ˆçš„æƒ…å†µä¸‹æ‰¾åˆ°ä»»ä½•èŠ‚ç‚¹çš„çˆ¶ç´¢å¼•æˆ–å­ç´¢å¼•ã€‚ è¿™æ ·æ¶ˆé™¤äº†ä½¿ç”¨æŒ‡é’ˆçš„å¤æ‚ï¼Œè¿™æ˜¯ä¸€ç§æƒè¡¡ï¼šæˆ‘ä»¬èŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œä½†éœ€è¦é¢å¤–çš„è®¡ç®—ã€‚ å¹¸è¿çš„æ˜¯ï¼Œè®¡ç®—é€Ÿåº¦å¾ˆå¿«ï¼Œåªéœ€è¦ **O(1)** æ—¶é—´ã€‚

ç†è§£æ ‘ä¸­æ•°ç»„ç´¢å¼•å’Œä½ç½®ä¹‹é—´çš„è¿™ç§å…³ç³»å¾ˆé‡è¦ã€‚ ä¸‹é¢ğŸ‘‡æ˜¯ä¸€ä¸ªæ›´å¤§çš„å †ï¼Œæœ‰15ä¸ªèŠ‚ç‚¹åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼š

![Large heap](Images/LargeHeap.png)


æ­¤å›¾ç‰‡ä¸­çš„æ•°å­—ä¸æ˜¯èŠ‚ç‚¹çš„å€¼ï¼Œè€Œæ˜¯å­˜å‚¨èŠ‚ç‚¹çš„æ•°ç»„ç´¢å¼•ï¼ ä¸‹é¢ğŸ‘‡æ˜¯æ•°ç»„ç´¢å¼•å¯¹åº”æ ‘çš„ä¸åŒçº§åˆ«ï¼š

![The heap array](Images/Array.png)

è¦ä½¿å…¬å¼èµ·ä½œç”¨ï¼Œçˆ¶èŠ‚ç‚¹å¿…é¡»å‡ºç°åœ¨æ•°ç»„ä¸­çš„å­èŠ‚ç‚¹ä¹‹å‰ã€‚ ä½ å¯ä»¥åœ¨ä¸Šé¢çš„å›¾ç‰‡ä¸­çœ‹åˆ°ã€‚

è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ¡ˆæœ‰å±€é™æ€§ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å¸¸è§„äºŒå‰æ ‘æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œä½†ä¸èƒ½ä½¿ç”¨å †æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

![Impossible with a heap](Images/RegularTree.png)


é™¤éå½“å‰æœ€ä½çº§åˆ«å·²æ»¡ï¼Œå¦åˆ™æ— æ³•å¼€å¯æ–°çº§åˆ«ï¼Œå› æ­¤å †æ€»æ˜¯å…·æœ‰è¿™ç§å½¢çŠ¶ï¼š

![The shape of a heap](Images/HeapShape.png)

> **æ³¨æ„ï¼š** æ‚¨*å¯ä»¥*ä½¿ç”¨å †æ¨¡æ‹Ÿå¸¸è§„äºŒå‰æ ‘ï¼Œä½†è¿™ä¼šæµªè´¹ç©ºé—´ï¼Œæ‚¨éœ€è¦å°†ä¸€äº›æ•°ç»„ç´¢å¼•æ ‡è®°ä¸ºç©ºã€‚



çªå‡»æµ‹éªŒï¼ å‡è®¾æˆ‘ä»¬æœ‰æ•°ç»„ï¼š

	[ 10, 14, 25, 33, 81, 82, 99 ]

è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å †å—ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ ä»ä½åˆ°é«˜çš„æ’åºæ•°ç»„æ˜¯æœ‰æ•ˆçš„*min-heap*ã€‚ æˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ç»˜åˆ¶è¿™ä¸ªå †ï¼š

![A sorted array is a valid heap](Images/SortedArray.png)


å †å±æ€§é€‚ç”¨äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºçˆ¶èŠ‚ç‚¹å§‹ç»ˆå°äºå…¶å­èŠ‚ç‚¹ã€‚ ï¼ˆè‡ªå·±éªŒè¯ä»é«˜åˆ°ä½æ’åºçš„æ•°ç»„å§‹ç»ˆæ˜¯æœ‰æ•ˆçš„*max-heap*ã€‚ï¼‰

> **æ³¨æ„ï¼š**ä½†å¹¶éæ¯ä¸ª*min-heap*éƒ½å¿…é¡»æ˜¯ä¸€ä¸ªæ’åºæ•°ç»„ï¼ æ’åºæ•°ç»„åªæ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚ è¦å°†å †é‡æ–°è½¬æ¢ä¸ºå·²æ’åºçš„æ•°ç»„ï¼Œéœ€è¦ä½¿ç”¨[å †æ’åº](../Heap%20Sort/)ã€‚



## æ›´å¤šæ•°å­¦ï¼

å¦‚æœä½ å¾ˆå¥½å¥‡ï¼Œè¿™é‡Œæœ‰ä¸€äº›æè¿°å †çš„æŸäº›å±æ€§çš„å…¬å¼ã€‚ ä½ ä¸éœ€è¦çŸ¥é“è¿™äº›ï¼Œä½†å®ƒä»¬æœ‰æ—¶ä¼šæ´¾ä¸Šç”¨åœºã€‚ å¯ä»¥è·³è¿‡æ­¤éƒ¨åˆ†ï¼

æ ‘çš„*height*å®šä¹‰ä¸ºä»æ ¹èŠ‚ç‚¹åˆ°æœ€ä½å¶èŠ‚ç‚¹æ‰€éœ€çš„æ­¥æ•°ï¼Œæˆ–è€…æ›´æ­£å¼ï¼š*height*æ˜¯èŠ‚ç‚¹ä¹‹é—´çš„æœ€å¤§è¾¹æ•°ã€‚ é«˜åº¦*h*çš„å †å…·æœ‰*h + 1*çº§åˆ«ã€‚

è¿™ä¸ªå †çš„é«˜åº¦ä¸º3ï¼Œæ‰€ä»¥å®ƒæœ‰4ä¸ªçº§åˆ«ï¼š

![Large heap](Images/LargeHeap.png)



å…·æœ‰*n*ä¸ªèŠ‚ç‚¹çš„å †å…·æœ‰é«˜åº¦*h = floor(log2(n))*ã€‚ è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ€»æ˜¯åœ¨æ·»åŠ æ–°çº§åˆ«ä¹‹å‰å®Œå…¨å¡«æ»¡æœ€ä½çº§åˆ«ã€‚ è¯¥ç¤ºä¾‹æœ‰15ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤é«˜åº¦ä¸º `floor(log2(15)) = floor(3.91) = 3`ã€‚

å¦‚æœæœ€ä½çº§åˆ«å·²æ»¡ï¼Œåˆ™è¯¥çº§åˆ«åŒ…å« *2^h* ä¸ªèŠ‚ç‚¹ã€‚ å®ƒä¸Šé¢çš„æ ‘çš„å…¶ä½™éƒ¨åˆ†åŒ…å« *2^h - 1* ä¸ªèŠ‚ç‚¹ã€‚ ä¸Šé¢ç¤ºä¾‹å°±æ˜¯ï¼šæœ€ä½çº§åˆ«æœ‰8ä¸ªèŠ‚ç‚¹ï¼Œå®é™…ä¸Šæ˜¯ `2^3 = 8` ã€‚ å‰ä¸‰ä¸ªçº§åˆ«åŒ…å«æ€»å…±7ä¸ªèŠ‚ç‚¹ï¼Œå³`2^3 - 1 = 8 - 1 = 7`ã€‚



å› æ­¤ï¼Œæ•´ä¸ªå †ä¸­çš„èŠ‚ç‚¹æ€»æ•°*n* ä¸º *2^(h+1) - 1*ã€‚ åœ¨ç¤ºä¾‹ä¸­ï¼Œ`2^4 - 1 = 16 - 1 = 15`ã€‚

åœ¨*n*ä¸ªå…ƒç´ å †ä¸­ï¼Œé«˜åº¦ä¸º*h*çš„æœ€å¤šæœ‰ *ceil(n/2^(h+1))* ä¸ªçš„èŠ‚ç‚¹ã€‚ï¼ˆ**è¯‘æ³¨ï¼š**ç¤ºä¾‹ä¸­hä¸º0æ—¶ï¼Œ`ceil(15/2^(0+1)) = 8`ï¼Œhä¸º1æ—¶,`ceil(15/2^(1+1)) = 4`ï¼‰

å¶èŠ‚ç‚¹æ€»æ˜¯ä½äºæ•°ç»„ç´¢å¼• *floor(n/2)* åˆ° *n-1*ã€‚(**è¯‘æ³¨ï¼š** `7 ~ 14`) æˆ‘ä»¬å°†åˆ©ç”¨è¿™ä¸€äº‹å®ä»æ•°ç»„ä¸­å¿«é€Ÿæ„å»ºå †ã€‚ å¦‚æœæ‚¨ä¸ç›¸ä¿¡ï¼Œè¯·éªŒè¯æ­¤ç¤ºä¾‹ã€‚;-)

åªæ˜¯ä¸€äº›æ•°å­¦å°±èƒ½ç…§äº®ä½ çš„ä¸€å¤©ã€‚â˜€ï¸



## ä½ èƒ½ç”¨å †åšä»€ä¹ˆï¼Ÿ



åœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ ä¹‹åï¼Œæœ‰ä¸¤ä¸ªå¿…è¦çš„åŸå§‹æ“ä½œæ¥ç¡®ä¿å †æ˜¯æœ‰æ•ˆçš„*max-heap*æˆ–*min-heap*ï¼š

- `shiftUp()`ï¼šå¦‚æœå…ƒç´ æ¯”å…¶çˆ¶å…ƒç´ æ›´å¤§ï¼ˆ*max-heap*ï¼‰æˆ–æ›´å°ï¼ˆ*min-heap*ï¼‰ï¼Œåˆ™éœ€è¦ä¸çˆ¶å…ƒç´ äº¤æ¢ï¼Œ è¿™ä½¿å…ƒç´ å‘ä¸Šç§»åŠ¨ã€‚

- `shiftDown()`ã€‚ å¦‚æœå…ƒç´ æ¯”å­å…ƒç´ å°ï¼ˆmax-heapï¼‰æˆ–æ›´å¤§ï¼ˆmin-heapï¼‰ï¼Œè¿™ä¸ªæ“ä½œä½¿å…ƒç´ å‘ä¸‹ç§»åŠ¨ï¼Œä¹Ÿç§°ä¸ºâ€œå †åŒ–(heapify)â€ã€‚

å‘ä¸Šæˆ–å‘ä¸‹ç§»åŠ¨æ˜¯ä¸€ä¸ªé€’å½’è¿‡ç¨‹ï¼Œéœ€è¦**O(log n)**æ—¶é—´ã€‚



ä»¥ä¸‹æ˜¯åŸºäºåŸå§‹æ“ä½œçš„å…¶ä»–æ“ä½œï¼š

- `insert(value)`ï¼šå°†æ–°å…ƒç´ æ·»åŠ åˆ°å †çš„æœ«å°¾ï¼Œç„¶åä½¿ç”¨`shiftUp()`æ¥ä¿®å¤å †ã€‚

- `remove()`ï¼šåˆ é™¤å¹¶è¿”å›æœ€å¤§å€¼(max-heapï¼‰æˆ–æœ€å°å€¼(min-heapï¼‰ã€‚ä¸ºäº†å¡«å……å…ƒç´ åˆ é™¤åç•™ä¸‹çš„ä½ç½®ï¼Œè®©æœ€åä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°æ ¹ä½ç½®ï¼Œç„¶åä½¿ç”¨`shiftDown()`ä¿®å¤å †ã€‚ (æœ‰æ—¶ç§°ä¸ºâ€œæå–æœ€å°å€¼â€æˆ–â€œæå–æœ€å¤§å€¼â€ã€‚ï¼‰

- `removeAtIndex(index)`ï¼šç±»ä¼¼`remove()`ï¼Œä¸ä»…å¯ä»¥åˆ é™¤æ ¹èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥ä»å †ä¸­åˆ é™¤ä»»ä½•èŠ‚ç‚¹ã€‚å¦‚æœæ–°å…ƒç´ ä¸å…¶å­å…ƒç´ ä¸è§„æ•´ï¼Œåˆ™è°ƒç”¨`shiftDown()`;å¦‚æœå…ƒç´ ä¸å…¶çˆ¶å…ƒç´ ä¸è§„æ•´ï¼Œåˆ™è°ƒç”¨`shiftUp()`ã€‚

- `replace(index, value)`ï¼šä¸ºèŠ‚ç‚¹åˆ†é…ä¸€ä¸ªè¾ƒå°(*min-heap*ï¼‰æˆ–è¾ƒå¤§(*max-heap*ï¼‰çš„å€¼ã€‚å› ä¸ºè¿™ä¼šä½¿å †å±æ€§å¤±æ•ˆï¼Œæ‰€ä»¥å®ƒä½¿ç”¨`shiftUp()`æ¥ä¿®å¤ã€‚ (ä¹Ÿç§°ä¸ºâ€œå‡å°‘é”®â€å’Œâ€œå¢åŠ é”®â€ã€‚ï¼‰



ä»¥ä¸Šæ‰€æœ‰æ“ä½œéƒ½éœ€è¦æ—¶é—´**O(log n)**å› ä¸ºå‘ä¸Šæˆ–å‘ä¸‹ç§»åŠ¨æ˜¯æ˜‚è´µçš„ã€‚è¿˜æœ‰ä¸€äº›æ“ä½œéœ€è¦æ›´å¤šæ—¶é—´ï¼š

- `search(value)`ã€‚å †ä¸æ˜¯ä¸ºé«˜æ•ˆæœç´¢è€Œæ„å»ºçš„ï¼Œä½†`replace()`å’Œ`removeAtIndex()`æ“ä½œéœ€è¦èŠ‚ç‚¹çš„æ•°ç»„ç´¢å¼•ï¼Œå› æ­¤æ‚¨éœ€è¦æ‰¾åˆ°è¯¥ç´¢å¼•ã€‚æ—¶é—´ï¼š**O(n)**ã€‚

- `buildHeap(array)`ï¼šé€šè¿‡é‡å¤è°ƒç”¨`insert()`å°†æ•°ç»„(æœªæ’åºçš„ï¼‰è½¬æ¢ä¸ºå †ã€‚å¦‚æœæ‚¨å¯¹æ­¤å¾ˆèªæ˜ï¼Œå¯ä»¥åœ¨**O(n)**æ—¶é—´å†…å®Œæˆã€‚

- [å †æ’åº](../Heap%20Sort/)ã€‚ç”±äºå †æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒçš„å”¯ä¸€å±æ€§å°†æ•°ç»„ä»ä½åˆ°é«˜æ’åºã€‚æ—¶é—´ï¼š**O(n lg n)ã€‚**

å †è¿˜æœ‰ä¸€ä¸ª`peek()`å‡½æ•°ï¼Œå®ƒè¿”å›æœ€å¤§(*max-heap*ï¼‰æˆ–æœ€å°(*min-heap*ï¼‰å…ƒç´ ï¼Œè€Œä¸ä»å †ä¸­åˆ é™¤å®ƒã€‚æ—¶é—´ï¼š**O(1)**ã€‚



> **æ³¨æ„ï¼š** åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å°†ä½¿ç”¨å †æ‰§è¡Œçš„æœ€å¸¸è§æ“ä½œæ˜¯ä½¿ç”¨`insert()`æ’å…¥æ–°å€¼ï¼Œå¹¶ä½¿ç”¨`remove()`åˆ é™¤æœ€å¤§å€¼æˆ–æœ€å°å€¼ã€‚ ä¸¤è€…éƒ½éœ€è¦**O(log n)**æ—¶é—´ã€‚ å…¶ä»–æ“ä½œç”¨æ¥æ”¯æŒæ›´é«˜çº§çš„ä½¿ç”¨ï¼Œä¾‹å¦‚æ„å»ºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå…¶ä¸­é¡¹ç›®çš„â€œé‡è¦æ€§â€åœ¨æ·»åŠ åˆ°é˜Ÿåˆ—åå¯ä»¥æ”¹å˜ã€‚



## å‘å †ä¸­æ’å…¥å…ƒç´  


æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ’å…¥ç¤ºä¾‹ï¼Œè¯¦ç»†äº†è§£å…¶å·¥ä½œåŸç†ã€‚ æˆ‘ä»¬å°†å€¼`16`æ’å…¥æ­¤å †ï¼š

![The heap before insertion](Images/Heap1.png)


è¿™ä¸ªå †çš„æ•°ç»„æ˜¯`[10, 7, 2, 5, 1]`ã€‚

æ’å…¥æ–°é¡¹ç›®çš„ç¬¬ä¸€æ­¥æ˜¯å°†å…¶é™„åŠ åˆ°æ•°ç»„çš„æœ«å°¾ã€‚ è¯¥æ•°ç»„å˜ä¸ºï¼š

	[ 10, 7, 2, 5, 1, 16 ]

æ ‘ç»“æ„å¦‚ä¸‹ï¼š

![The heap before insertion](Images/Insert1.png)

`(16)`è¢«æ·»åŠ åˆ°æœ€åä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå¯ç”¨ç©ºé—´ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œå †å±æ€§ä¸å†æ»¡è¶³ï¼Œå› ä¸º`(2)`é«˜äº`(16)`ï¼Œæˆ‘ä»¬å¸Œæœ›æ›´é«˜çš„æ•°å­—é«˜äºä½çš„æ•°å­—ã€‚ (è¿™æ˜¯*max-heap*ã€‚)

è¦æ¢å¤å †å±æ€§ï¼Œæˆ‘ä»¬äº¤æ¢`(16)`å’Œ`(2)`ã€‚

![The heap before insertion](Images/Insert2.png)


æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œæˆï¼Œå› ä¸º`(10)`ä¹Ÿå°äº`(16)`ã€‚ æˆ‘ä»¬ç»§ç»­å°†å…¶æ’å…¥å€¼ä¸å…¶çˆ¶é¡¹äº¤æ¢ï¼Œç›´åˆ°çˆ¶é¡¹æ›´å¤§æˆ–åˆ°è¾¾æ ‘çš„é¡¶éƒ¨ã€‚ è¿™ç§°ä¸º**shift-up** æˆ– **sifting** ï¼Œå¹¶åœ¨æ¯æ¬¡æ’å…¥åå®Œæˆã€‚ å®ƒä¼šä½¿ä¸€ä¸ªå¤ªå¤§æˆ–å¤ªå°çš„æ•°å­—â€œæµ®èµ·â€æ ‘ã€‚


æœ€åï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š

![The heap before insertion](Images/Insert3.png)



ç°åœ¨æ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½æ¯”å…¶å­èŠ‚ç‚¹æ›´å¤§äº†ã€‚

ä¸Šç§»æ‰€éœ€çš„æ—¶é—´ä¸æ ‘çš„é«˜åº¦æˆæ­£æ¯”ï¼Œéœ€è¦**O(log n)**æ—¶é—´ã€‚ï¼ˆå°†èŠ‚ç‚¹é™„åŠ åˆ°æ•°ç»„æœ«å°¾æ‰€éœ€çš„æ—¶é—´ä»…ä¸º**O(1)**ï¼Œå› æ­¤ä¸ä¼šé™ä½å®ƒçš„é€Ÿåº¦ã€‚ï¼‰



## åˆ é™¤æ ¹èŠ‚ç‚¹

ä»æ ‘ä¸­ç§»é™¤`(10)`ï¼š

![The heap before removal](Images/Heap1.png)

é¡¶éƒ¨çš„ç©ºç™½æ€ä¹ˆåŠï¼Ÿ

![The root is gone](Images/Remove1.png)


æ’å…¥æ—¶ï¼Œæˆ‘ä»¬å°†æ–°å€¼æ”¾åœ¨æ•°ç»„çš„æœ«å°¾ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åšç›¸åçš„äº‹æƒ…ï¼šæˆ‘ä»¬é‡‡ç”¨æˆ‘ä»¬æ‹¥æœ‰çš„æœ€åä¸€ä¸ªå¯¹è±¡ï¼Œå°†å…¶ç›´æ¥ç§»åŠ¨åˆ°æ ‘çš„é¡¶éƒ¨ï¼Œç„¶åæ¢å¤å †å±æ€§ã€‚

![The last node goes to the root](Images/Remove2.png)


è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•**shift-down**`(1)`ã€‚ è¦ç»´æŠ¤æ­¤*max-heap*çš„å †å±æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›é¡¶éƒ¨ä¸ºæœ€å¤§æ•°ã€‚ æˆ‘ä»¬æœ‰ä¸¤ä¸ªäº¤æ¢ä½ç½®çš„å€™é€‰è€…ï¼š`(7)`å’Œ`(2)`ã€‚ é€‰æ‹©è¿™ä¸‰ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æœ€é«˜æ•°å­—ä½äºé¡¶éƒ¨ï¼Œé‚£æ˜¯`(7)`ï¼Œæ‰€ä»¥äº¤æ¢`(1)`å’Œ`(7)ï¼Œå¾—åˆ°ä¸‹é¢ğŸ‘‡çš„æ ‘ï¼š

![The last node goes to the root](Images/Remove3.png)


ç»§ç»­å‘ä¸‹ç§»åŠ¨ï¼Œç›´åˆ°èŠ‚ç‚¹æ²¡æœ‰ä»»ä½•å­èŠ‚ç‚¹ï¼Œæˆ–è€…å®ƒæ¯”ä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½å¤§ã€‚ å¯¹äºè¿™ä¸ªå †ï¼Œåªéœ€è¦ä¸€ä¸ªäº¤æ¢æ¥æ¢å¤å †å±æ€§ï¼š

![The last node goes to the root](Images/Remove4.png)


å®Œå…¨å‘ä¸‹ç§»åŠ¨æ‰€éœ€çš„æ—¶é—´ä¸æ ‘çš„é«˜åº¦æˆæ­£æ¯”ï¼Œè¿™éœ€è¦**O(log n)**æ—¶é—´ã€‚

> **æ³¨æ„ï¼š** `shiftUp()`å’Œ`shiftDown()`ä¸€æ¬¡åªèƒ½ä¿®å¤ä¸€ä¸ªå¼‚å¸¸å…ƒç´ ã€‚ å¦‚æœé”™è¯¯çš„ä½ç½®æœ‰å¤šä¸ªå…ƒç´ ï¼Œåˆ™éœ€è¦ä¸ºæ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡è¿™äº›å‡½æ•°ã€‚



## åˆ é™¤ä»»æ„èŠ‚ç‚¹


ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå°†åˆ é™¤çš„æ˜¯å †æ ¹èŠ‚ç‚¹ï¼Œå› ä¸ºè¿™æ˜¯å †è®¾è®¡çš„ç›®çš„ã€‚


ä½†æ˜¯ï¼Œåˆ é™¤ä»»æ„å…ƒç´ å¯èƒ½å¾ˆæœ‰ç”¨ã€‚ è¿™æ˜¯`remove()`çš„ä¸€èˆ¬ç‰ˆæœ¬ï¼Œå¯èƒ½æ¶‰åŠ`shiftDown()`æˆ–`shiftUp()`ã€‚

è®©æˆ‘ä»¬å†æ¬¡é‡‡ç”¨å‰é¢çš„ç¤ºä¾‹æ ‘ï¼Œåˆ é™¤`(7)`ï¼š

![The heap before removal](Images/Heap1.png)

æé†’ä¸€ä¸‹ï¼Œæ•°ç»„æ˜¯ï¼š

	[ 10, 7, 2, 5, 1 ]


å¦‚æ‚¨æ‰€çŸ¥ï¼Œåˆ é™¤å…ƒç´ å¯èƒ½ä¼šä½¿max-heapæˆ–min-heapå±æ€§å¤±æ•ˆã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†è¦ç§»é™¤çš„èŠ‚ç‚¹ä¸æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼š

	[ 10, 1, 2, 5, 7 ]


æœ€åä¸€ä¸ªå…ƒç´ æ˜¯æˆ‘ä»¬å°†è¿”å›çš„å…ƒç´ ; æˆ‘ä»¬å°†è°ƒç”¨`removeLast()`å°†å…¶ä»å †ä¸­åˆ é™¤ã€‚ `(1)`ç°åœ¨æ˜¯ä¹±åºçš„ï¼Œå› ä¸ºå®ƒå°äºå®ƒçš„å­èŠ‚ç‚¹ï¼Œ`(5)`æ˜¯åœ¨æ ‘ä¸­åº”è¯¥æ›´é«˜ã€‚ æˆ‘ä»¬è°ƒç”¨`shiftDown()`æ¥ä¿®å¤å®ƒã€‚


ä½†æ˜¯ï¼Œå‘ä¸‹ç§»åŠ¨å¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†çš„å”¯ä¸€æƒ…å†µã€‚ ä¹Ÿå¯èƒ½å‘ç”Ÿæ–°å…ƒç´ å¿…é¡»å‘ä¸Šç§»åŠ¨ã€‚ è€ƒè™‘å¦‚æœä»ä»¥ä¸‹å †ä¸­åˆ é™¤`(5)`ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

![We need to shift up](Images/Remove5.png)

> è¯‘æ³¨ï¼šè¿™ä¸ªçš„æ ‘å¯¹åº”çš„æ•°ç»„æ˜¯`[10, 7, 9, 5, 1, 2, 8]`ã€‚

ç°åœ¨`(5)`ä¸`(8)`äº¤æ¢ã€‚ å› ä¸º`(8)`æ¯”å®ƒçš„çˆ¶èŠ‚ç‚¹(`(7)`)å¤§ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨`shiftUp()`ã€‚



## ç”¨æ•°ç»„åˆ›å»ºå † 


å°†æ•°ç»„è½¬æ¢ä¸ºå †å¯ä»¥å¾ˆæ–¹ä¾¿ã€‚ åªæ˜¯å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ´—ç‰Œï¼Œç›´åˆ°æ»¡è¶³å †å±æ€§ã€‚

åœ¨ä»£ç ä¸­å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```swift
  private mutating func buildHeap(fromArray array: [T]) {
    for value in array {
      insert(value)
    }
  }
```



æˆ‘ä»¬åªè¦ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼è°ƒç”¨`insert()`ã€‚ ç®€å•ä½†ä¸æ˜¯å¾ˆé«˜æ•ˆã€‚ è¿™æ€»å…±éœ€è¦**O(n log n)**æ—¶é—´ï¼Œå› ä¸ºæœ‰**n**ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªæ’å…¥éœ€è¦**log n**æ—¶é—´ã€‚

å¦‚æœä½ æ²¡æœ‰è·³è¿‡å‰é¢æ•°å­¦éƒ¨åˆ†ï¼Œä½ å·²ç»çœ‹åˆ°ï¼Œå¯¹äºä»»ä½•å †ï¼Œæ•°ç»„ç´¢å¼•*n / 2*åˆ°*n-1*çš„å…ƒç´ éƒ½æ˜¯æ ‘çš„å¶èŠ‚ç‚¹ã€‚ æˆ‘ä»¬å¯ä»¥ç®€å•åœ°è·³è¿‡é‚£äº›å¶å­ã€‚ æˆ‘ä»¬åªéœ€è¦å¤„ç†å…¶ä»–èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤å¯èƒ½æ˜¯é”™è¯¯çš„é¡ºåºã€‚

ä»£ç :

```swift
  private mutating func buildHeap(fromArray array: [T]) {
    elements = array
    for i in stride(from: (nodes.count/2-1), through: 0, by: -1) {
      shiftDown(index: i, heapSize: elements.count)
    }
  }
```


è¿™é‡Œï¼Œ`elements`æ˜¯å †è‡ªå·±çš„æ•°ç»„ã€‚ æˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªéå¶èŠ‚ç‚¹å¼€å§‹å‘åéå†è¿™ä¸ªæ•°ç»„ï¼Œå¹¶è°ƒç”¨`shiftDown()`ã€‚ è¿™ä¸ªç®€å•çš„å¾ªç¯ä»¥æ­£ç¡®çš„é¡ºåºæ”¾ç½®è¿™äº›èŠ‚ç‚¹ä»¥åŠæˆ‘ä»¬è·³è¿‡çš„å¶èŠ‚ç‚¹ã€‚ è¿™è¢«ç§°ä¸º**Floydç®—æ³•**ï¼Œåªéœ€è¦**O(n)**æ—¶é—´ã€‚ âœŒï¸



## æœç´¢å † 


å †ä¸èƒ½ç”¨äºå¿«é€Ÿæœç´¢ï¼Œä½†å¦‚æœè¦ä½¿ç”¨`removeAtIndex()`åˆ é™¤ä»»æ„å…ƒç´ æˆ–ä½¿ç”¨`replace()`æ›´æ”¹å…ƒç´ çš„å€¼ï¼Œåˆ™éœ€è¦è·å–è¯¥å…ƒç´ çš„ç´¢å¼•ã€‚æœç´¢å †é€Ÿåº¦å¾ˆæ…¢ã€‚


åœ¨[äºŒå‰æœç´¢æ ‘](../Binary%20Search%20Tree/)ä¸­ï¼Œæ ¹æ®èŠ‚ç‚¹çš„é¡ºåºï¼Œå¯ä»¥ä¿è¯å¿«é€Ÿæœç´¢ã€‚ ç”±äºå †ä»¥ä¸åŒæ–¹å¼å¯¹å…¶èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œå› æ­¤äºŒå‰æœç´¢ä¸èµ·ä½œç”¨ï¼Œæ‚¨éœ€è¦æ£€æŸ¥æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚

å†ç»™å‡ºä¸Šé¢å †ç¤ºä¾‹ï¼š

![The heap](Images/Heap1.png)



å¦‚æœæˆ‘ä»¬æƒ³è¦æœç´¢èŠ‚ç‚¹`(1)`çš„ç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çº¿æ€§æœç´¢åˆ†æ­¥æœç´¢æ•°ç»„`[10, 7, 2, 5, 1]`ã€‚

å³ä½¿å †å±æ€§æ²¡æœ‰è€ƒè™‘åˆ°æœç´¢ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥åˆ©ç”¨å®ƒã€‚ æˆ‘ä»¬çŸ¥é“åœ¨*max-heap*ä¸­çˆ¶èŠ‚ç‚¹æ€»æ˜¯æ¯”å®ƒçš„å­èŠ‚ç‚¹å¤§ï¼Œæ‰€ä»¥å¦‚æœçˆ¶èŠ‚ç‚¹å·²ç»å°äºæˆ‘ä»¬è¦æŸ¥æ‰¾çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥é‚£äº›å­èŠ‚ç‚¹(åŠå…¶å­èŠ‚ç‚¹ç­‰ç­‰ï¼‰ã€‚

å‡è®¾æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹å †æ˜¯å¦åŒ…å«å€¼`8`(æ²¡æœ‰åŒ…å«)ã€‚ æˆ‘ä»¬ä»æ ¹`(10)`å¼€å§‹ã€‚ è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€’å½’åœ°çœ‹çœ‹å®ƒçš„å·¦å³å­èŠ‚ç‚¹ã€‚ å·¦è¾¹çš„å­©å­æ˜¯`(7)`ã€‚ è¿™ä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œä½†ç”±äºè¿™æ˜¯ä¸€ä¸ª*max-heap*ï¼Œæˆ‘ä»¬çŸ¥é“æŸ¥çœ‹`(7)`çš„å­èŠ‚ç‚¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå®ƒä»¬æ€»æ˜¯å°äº`7`ï¼Œå› æ­¤å·¦ä¾§ä¸ä¼šæ‰¾åˆ°`8`ã€‚ åŒæ ·ï¼Œå¯¹äºå³èŠ‚ç‚¹ï¼Œ`(2)`ï¼Œä¹Ÿæ‰¾ä¸åˆ°ã€‚

å°½ç®¡æœ‰ä¸€ç‚¹ä¼˜åŒ–ï¼Œæœç´¢ä»ç„¶æ˜¯**O(n)**æ“ä½œã€‚



> **æ³¨æ„ï¼š** æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥é€šè¿‡ä¿ç•™ä¸€ä¸ªå°†èŠ‚ç‚¹å€¼æ˜ å°„åˆ°ç´¢å¼•çš„é™„åŠ å­—å…¸æ¥å°†æŸ¥æ‰¾è½¬æ¢ä¸º**O(1)**æ“ä½œã€‚ å¦‚æœä½ ç»å¸¸éœ€è¦è°ƒç”¨`replace()`æ¥æ”¹å˜æ„å»ºåœ¨å †ä¸Šçš„[ä¼˜å…ˆé˜Ÿåˆ—](../Priority%20Queue/)ä¸­å¯¹è±¡çš„â€œä¼˜å…ˆçº§â€ï¼Œè¿™å¯èƒ½æ˜¯å€¼å¾—åšçš„ã€‚



## ä»£ç 


æœ‰å…³ç”¨Swiftä»£ç å®ç°ï¼Œè¯·å‚è§[Heap.swift](Heap.swift)ã€‚ å¤§å¤šæ•°ä»£ç éƒ½å¾ˆç®€å•ã€‚ å”¯ä¸€æ£˜æ‰‹çš„æ˜¯`shiftUp()`å’Œ`shiftDown()`ã€‚

æ‚¨å·²ç»çŸ¥é“æœ‰ä¸¤ç§ç±»å‹çš„å †ï¼š*max-heap*å’Œ*min-heap*ã€‚ å®ƒä»¬ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«åœ¨äºå®ƒä»¬å¦‚ä½•å¯¹èŠ‚ç‚¹è¿›è¡Œæ’åºï¼šé¦–å…ˆæ˜¯æœ€å¤§å€¼æˆ–æœ€å°å€¼ã€‚

ä¸æ˜¯åˆ›å»ºä¸¤ä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼Œ`MaxHeap`å’Œ`MinHeap`ï¼Œè€Œåªæœ‰ä¸€ä¸ª`Heap`å¯¹è±¡ï¼Œå®ƒéœ€è¦ä¸€ä¸ª`isOrderedBefore`é—­åŒ…ã€‚ æ­¤é—­åŒ…åŒ…å«ç¡®å®šä¸¤ä¸ªå€¼çš„é¡ºåºçš„é€»è¾‘ã€‚ ä½ ä¹‹å‰å¯èƒ½å·²ç»çœ‹è¿‡äº†ï¼Œå› ä¸ºå®ƒä¹Ÿæ˜¯Swiftçš„`sort()`çš„å·¥ä½œåŸç†ã€‚


è¦åˆ›å»ºä¸€ä¸ªmax-heapæ•´æ•°å †ï¼š

```swift
var maxHeap = Heap<Int>(sort: >)
```

è¦åˆ›å»ºä¸€ä¸ªmin-heapæ•´æ•°å †ï¼š

```swift
var minHeap = Heap<Int>(sort: <)
```

I just wanted to point this out, because where most heap implementations use the `<` and `>` operators to compare values, this one uses the `isOrderedBefore()` closure.
æˆ‘åªæƒ³æŒ‡å‡ºè¿™ä¸€ç‚¹ï¼Œå› ä¸ºå¤§å¤šæ•°å †å®ç°ä½¿ç”¨`<`å’Œ`>`è¿ç®—ç¬¦æ¥æ¯”è¾ƒå€¼ï¼Œè¿™ä¸ªä½¿ç”¨`isOrderedBefore()`é—­åŒ…ã€‚

## æ‰©å±•é˜…è¯»

[Heapçš„ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Heap_%28data_structure%29)



*ä½œè€…ï¼š[Kevin Randrup](http://www.github.com/kevinrandrup)ï¼Œ Matthijs Hollemans*   
*ç¿»è¯‘ï¼š[Andy Ron](https://github.com/andyRon)*   
*æ ¡å¯¹ï¼š[Andy Ron](https://github.com/andyRon)*   

